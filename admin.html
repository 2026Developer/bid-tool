<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æŠ•æ ‡å·¥å…·æˆæƒç®¡ç†ç«¯</title>
    <style>
        * {
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
        }
        
        body {
            background-color: #f5f7fa;
            color: #333;
            margin: 0;
            padding: 20px;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            padding: 30px;
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eaeaea;
        }
        
        h1 {
            color: #2c3e50;
            margin-top: 0;
        }
        
        .subtitle {
            color: #7f8c8d;
            font-size: 1.1rem;
        }
        
        .section {
            margin-bottom: 40px;
            padding: 25px;
            border-radius: 8px;
            background-color: #f8f9fa;
        }
        
        .section h2 {
            color: #2c3e50;
            margin-top: 0;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #ecf0f1;
        }
        
        .section h3 {
            color: #34495e;
            margin-top: 0;
            margin-bottom: 15px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #34495e;
        }
        
        input, select, textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
            transition: border 0.3s;
        }
        
        input:focus, select:focus, textarea:focus {
            border-color: #3498db;
            outline: none;
            box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.2);
        }
        
        textarea {
            font-family: 'Courier New', monospace;
            min-height: 120px;
            resize: vertical;
        }
        
        .code-display {
            background-color: white;
            padding: 15px;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            font-weight: bold;
            margin-bottom: 15px;
            border: 1px solid #ddd;
            word-break: break-all;
            font-size: 14px;
        }
        
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .btn-primary {
            background-color: #3498db;
            color: white;
        }
        
        .btn-primary:hover {
            background-color: #2980b9;
        }
        
        .btn-success {
            background-color: #2ecc71;
            color: white;
        }
        
        .btn-success:hover {
            background-color: #27ae60;
        }
        
        .btn-warning {
            background-color: #f39c12;
            color: white;
        }
        
        .btn-warning:hover {
            background-color: #d68910;
        }
        
        .btn-danger {
            background-color: #e74c3c;
            color: white;
        }
        
        .btn-danger:hover {
            background-color: #c0392b;
        }
        
        .button-group {
            display: flex;
            gap: 15px;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        
        .status-message {
            margin-top: 15px;
            padding: 12px;
            border-radius: 5px;
            font-size: 14px;
            text-align: center;
            display: none;
        }
        
        .status-success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
            display: block;
        }
        
        .status-error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
            display: block;
        }
        
        .status-info {
            background-color: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
            display: block;
        }
        
        .record-item {
            background-color: white;
            padding: 15px;
            border-radius: 6px;
            margin-bottom: 15px;
            border: 1px solid #e0e0e0;
            transition: all 0.3s;
        }
        
        .record-item:hover {
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            transform: translateY(-2px);
        }
        
        .record-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .record-code {
            font-family: 'Courier New', monospace;
            font-weight: bold;
            color: #2c3e50;
        }
        
        .record-type {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 10px;
            font-size: 0.8rem;
            font-weight: bold;
        }
        
        .type-1 { background-color: #e3f2fd; color: #1565c0; }
        .type-3 { background-color: #e8f5e9; color: #2e7d32; }
        .type-10 { background-color: #fff3e0; color: #f57c00; }
        .type-999 { background-color: #f3e5f5; color: #7b1fa2; }
        
        .record-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
            margin-top: 10px;
            font-size: 0.9rem;
            color: #7f8c8d;
        }
        
        .record-actions {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }
        
        .record-actions .btn {
            padding: 6px 12px;
            font-size: 12px;
        }
        
        .search-box {
            margin-bottom: 20px;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            border-top: 4px solid #3498db;
        }
        
        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: #2c3e50;
            margin: 10px 0;
        }
        
        .stat-label {
            font-size: 0.9rem;
            color: #7f8c8d;
        }
        
        .email-template {
            background-color: #fff8e1;
            padding: 15px;
            border-radius: 6px;
            margin-top: 15px;
            border: 1px solid #f39c12;
            font-size: 12px;
            font-family: monospace;
            white-space: pre-wrap;
            word-break: break-all;
        }
        
        .email-template h4 {
            color: #d68910;
            margin-top: 0;
            margin-bottom: 10px;
        }
        
        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .footer {
            text-align: center;
            margin-top: 40px;
            color: #7f8c8d;
            font-size: 0.9rem;
            border-top: 1px solid #eee;
            padding-top: 20px;
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            .button-group {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
            }
            
            .record-actions {
                flex-direction: column;
            }
            
            .form-row {
                grid-template-columns: 1fr;
            }
        }
        
        .tab-container {
            margin-bottom: 30px;
        }
        
        .tabs {
            display: flex;
            border-bottom: 2px solid #ecf0f1;
            margin-bottom: 20px;
        }
        
        .tab {
            padding: 12px 24px;
            background: none;
            border: none;
            border-bottom: 3px solid transparent;
            font-weight: 600;
            cursor: pointer;
            color: #7f8c8d;
            transition: all 0.3s;
        }
        
        .tab:hover {
            color: #3498db;
        }
        
        .tab.active {
            color: #3498db;
            border-bottom-color: #3498db;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
            font-size: 14px;
        }
        
        .data-table th {
            background-color: #2c3e50;
            color: white;
            font-weight: 600;
            padding: 12px;
            text-align: left;
        }
        
        .data-table td {
            padding: 10px 12px;
            border-bottom: 1px solid #e0e0e0;
        }
        
        .data-table tr:nth-child(even) {
            background-color: #f8f9fa;
        }
        
        .data-table tr:hover {
            background-color: #ecf0f1;
        }
        
        .copy-btn {
            background-color: #9b59b6;
            color: white;
            border: none;
            padding: 4px 8px;
            border-radius: 3px;
            cursor: pointer;
            font-size: 11px;
        }
        
        .copy-btn:hover {
            background-color: #8e44ad;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>æŠ•æ ‡å·¥å…·æˆæƒç®¡ç†ç«¯</h1>
            <p class="subtitle">å¼€å‘è€…ä¸“ç”¨ - ç”¨äºç”Ÿæˆå’Œç®¡ç†ç”¨æˆ·æˆæƒç </p>
        </div>
        
        <div class="tab-container">
            <div class="tabs">
                <button class="tab active" onclick="showTab('generate')">ç”Ÿæˆæˆæƒç </button>
                <button class="tab" onclick="showTab('verify')">éªŒè¯æˆæƒç </button>
                <button class="tab" onclick="showTab('records')">æˆæƒè®°å½•</button>
                <button class="tab" onclick="showTab('users')">ç”¨æˆ·ç®¡ç†</button>
                <button class="tab" onclick="showTab('stats')">æ•°æ®ç»Ÿè®¡</button>
            </div>
            
            <!-- ç”Ÿæˆæˆæƒç æ ‡ç­¾ -->
            <div id="generate-tab" class="tab-content active">
                <div class="section">
                    <h2>ç”Ÿæˆæˆæƒç </h2>
                    <p>ä½¿ç”¨æ­¤å·¥å…·ä¸ºç”¨æˆ·ç”Ÿæˆæˆæƒç ã€‚éœ€è¦ç”¨æˆ·çš„æˆæƒè¯·æ±‚ç å’Œæ”¯ä»˜ä¿¡æ¯ã€‚</p>
                    
                    <div class="form-group">
                        <label for="authRequestCode">ç”¨æˆ·æˆæƒè¯·æ±‚ç ï¼š</label>
                        <input type="text" id="authRequestCode" placeholder="è¾“å…¥ç”¨æˆ·å‘é€çš„æˆæƒè¯·æ±‚ç ï¼Œæ ¼å¼ï¼šAUTH-REQ-æ—¶é—´æˆ³-éšæœºç ">
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="userAmount">æ”¯ä»˜é‡‘é¢ï¼š</label>
                            <select id="userAmount">
                                <option value="8">8å…ƒ - 1æ¬¡ä½¿ç”¨</option>
                                <option value="18">18å…ƒ - 3æ¬¡ä½¿ç”¨</option>
                                <option value="58">58å…ƒ - 10æ¬¡ä½¿ç”¨</option>
                                <option value="88">88å…ƒ - ç»ˆç”Ÿä½¿ç”¨</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="userEmail">ç”¨æˆ·é‚®ç®±ï¼š</label>
                            <input type="email" id="userEmail" placeholder="ç”¨æˆ·é‚®ç®±ï¼Œç”¨äºå‘é€æˆæƒç ">
                        </div>
                        
                        <div class="form-group">
                            <label for="userName">ç”¨æˆ·å§“å/å…¬å¸ï¼š</label>
                            <input type="text" id="userName" placeholder="ç”¨æˆ·å§“åæˆ–å…¬å¸åç§°">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="paymentProof">æ”¯ä»˜å‡­è¯æˆªå›¾ï¼ˆå¯é€‰ï¼‰ï¼š</label>
                        <textarea id="paymentProof" placeholder="å¯ä»¥åœ¨æ­¤è®°å½•ç”¨æˆ·çš„æ”¯ä»˜å‡­è¯ä¿¡æ¯ï¼Œå¦‚å¾®ä¿¡æ”¯ä»˜æˆªå›¾æè¿°ç­‰"></textarea>
                    </div>
                    
                    <div class="button-group">
                        <button class="btn btn-primary" onclick="generateLicense()">
                            ğŸ”‘ ç”Ÿæˆæˆæƒç 
                        </button>
                        <button class="btn btn-warning" onclick="testLicenseGeneration()">
                            ğŸ§ª æµ‹è¯•ç”Ÿæˆ
                        </button>
                        <button class="btn btn-success" onclick="copyLicenseCode()" id="copyBtn" disabled>
                            ğŸ“‹ å¤åˆ¶æˆæƒç 
                        </button>
                    </div>
                    
                    <div id="generateStatus" class="status-message"></div>
                    
                    <div id="licenseResult" style="display: none;">
                        <h3>ç”Ÿæˆçš„æˆæƒç ï¼š</h3>
                        <div id="licenseCodeDisplay" class="code-display"></div>
                        
                        <h3>é‚®ä»¶å›å¤æ¨¡æ¿ï¼š</h3>
                        <div class="email-template">
                            <h4>å›å¤ç»™ç”¨æˆ·çš„é‚®ä»¶æ¨¡æ¿</h4>
ä¸»é¢˜ï¼šæŠ•æ ‡å·¥å…·æˆæƒç  - [ç”¨æˆ·å§“å/å…¬å¸å]

å°Šæ•¬çš„[ç”¨æˆ·å§“å/å…¬å¸å]ï¼š

æ‚¨å¥½ï¼

å·²æ”¶åˆ°æ‚¨çš„æ”¯ä»˜å‡­è¯å’Œæˆæƒè¯·æ±‚ï¼Œæ„Ÿè°¢æ‚¨å¯¹æŠ•æ ‡ä»·æ ¼è¯„åˆ†ä¼°ç®—å·¥å…·çš„æ”¯æŒï¼

æ‚¨çš„æˆæƒç å·²ç”Ÿæˆï¼š

ã€æˆæƒç ã€‘
<div id="emailLicenseCode" style="font-weight: bold; margin: 10px 0; padding: 10px; background: #fff; border: 1px dashed #3498db;"></div>

ã€ä½¿ç”¨è¯´æ˜ã€‘
1. æ‰“å¼€"æŠ•æ ‡ä»·æ ¼è¯„åˆ†ä¼°ç®—å·¥å…·"
2. ç‚¹å‡»"å¯¼å…¥æˆæƒç "æŒ‰é’®
3. ç²˜è´´ä¸Šé¢çš„æˆæƒç 
4. ç‚¹å‡»"æ¿€æ´»æˆæƒ"æŒ‰é’®
5. æ¿€æ´»æˆåŠŸåå³å¯è·å¾—å¯¹åº”çš„ä½¿ç”¨æ¬¡æ•°

ã€æ³¨æ„äº‹é¡¹ã€‘
1. æ­¤æˆæƒç ä»…é™æ‚¨å½“å‰ç”µè„‘ä½¿ç”¨
2. æˆæƒç æœ‰æ•ˆæœŸä¸º30å¤©
3. å¦‚æœ‰é—®é¢˜è¯·è”ç³»ï¼š65496209@qq.com

æ„Ÿè°¢æ‚¨çš„æ”¯æŒï¼
ç¥æ‚¨å·¥ä½œé¡ºåˆ©ï¼

å¼€å‘è€…ï¼š2026Developer@sy
                        </div>
                        
                        <div class="button-group">
                            <button class="btn btn-success" onclick="copyEmailTemplate()">
                                ğŸ“§ å¤åˆ¶é‚®ä»¶æ¨¡æ¿
                            </button>
                            <button class="btn btn-primary" onclick="saveLicenseRecord()">
                                ğŸ’¾ ä¿å­˜è®°å½•
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- éªŒè¯æˆæƒç æ ‡ç­¾ -->
            <div id="verify-tab" class="tab-content">
                <div class="section">
                    <h2>éªŒè¯æˆæƒç </h2>
                    <p>éªŒè¯ç”¨æˆ·æä¾›çš„æˆæƒç æ˜¯å¦æœ‰æ•ˆï¼Œä»¥åŠæŸ¥è¯¢æˆæƒç çš„è¯¦ç»†ä¿¡æ¯ã€‚</p>
                    
                    <div class="form-group">
                        <label for="verifyLicenseCode">è¾“å…¥æˆæƒç è¿›è¡ŒéªŒè¯ï¼š</label>
                        <input type="text" id="verifyLicenseCode" placeholder="è¾“å…¥æˆæƒç è¿›è¡ŒéªŒè¯">
                    </div>
                    
                    <div class="button-group">
                        <button class="btn btn-primary" onclick="verifyLicense()">
                            ğŸ” éªŒè¯æˆæƒç 
                        </button>
                        <button class="btn btn-warning" onclick="loadAllLicenses()">
                            ğŸ“‹ åŠ è½½æ‰€æœ‰è®°å½•
                        </button>
                    </div>
                    
                    <div id="verifyStatus" class="status-message"></div>
                    
                    <div id="verifyResult" style="display: none; margin-top: 20px;">
                        <h3>æˆæƒç è¯¦ç»†ä¿¡æ¯ï¼š</h3>
                        <div class="record-item">
                            <div class="record-header">
                                <span class="record-code" id="verifyCode"></span>
                                <span class="record-type" id="verifyType"></span>
                            </div>
                            <div class="record-details">
                                <div><strong>ä½¿ç”¨æ¬¡æ•°ï¼š</strong><span id="verifyTimes"></span></div>
                                <div><strong>å¯¹åº”é‡‘é¢ï¼š</strong><span id="verifyAmount"></span></div>
                                <div><strong>ç”Ÿæˆæ—¶é—´ï¼š</strong><span id="verifyGenerated"></span></div>
                                <div><strong>æ¿€æ´»çŠ¶æ€ï¼š</strong><span id="verifyStatusText"></span></div>
                                <div><strong>æ¿€æ´»æ—¶é—´ï¼š</strong><span id="verifyActivated"></span></div>
                                <div><strong>æœºå™¨ç ï¼š</strong><span id="verifyMachineCode"></span></div>
                            </div>
                        </div>
                    </div>
                    
                    <div id="allLicenses" style="display: none; margin-top: 20px;">
                        <h3>æ‰€æœ‰æˆæƒè®°å½•ï¼š</h3>
                        <div id="licensesList"></div>
                    </div>
                </div>
            </div>
            
            <!-- æˆæƒè®°å½•æ ‡ç­¾ -->
            <div id="records-tab" class="tab-content">
                <div class="section">
                    <h2>æˆæƒè®°å½•ç®¡ç†</h2>
                    <p>æŸ¥çœ‹å’Œç®¡ç†æ‰€æœ‰ç”Ÿæˆçš„æˆæƒç è®°å½•ã€‚</p>
                    
                    <div class="search-box">
                        <input type="text" id="searchRecords" placeholder="æœç´¢æˆæƒç ã€é‚®ç®±æˆ–æœºå™¨ç ..." onkeyup="searchLicenseRecords()" style="width: 100%;">
                    </div>
                    
                    <div class="button-group">
                        <button class="btn btn-primary" onclick="loadLicenseRecords()">
                            ğŸ”„ åˆ·æ–°è®°å½•
                        </button>
                        <button class="btn btn-warning" onclick="exportRecordsToCSV()">
                            ğŸ“Š å¯¼å‡ºä¸ºCSV
                        </button>
                        <button class="btn btn-danger" onclick="clearAllRecords()">
                            ğŸ—‘ï¸ æ¸…ç©ºæ‰€æœ‰è®°å½•
                        </button>
                    </div>
                    
                    <div id="recordsStatus" class="status-message"></div>
                    
                    <div id="recordsList" style="margin-top: 20px;">
                        <!-- æˆæƒè®°å½•å°†åŠ¨æ€åŠ è½½åœ¨è¿™é‡Œ -->
                    </div>
                </div>
            </div>
            
            <!-- ç”¨æˆ·ç®¡ç†æ ‡ç­¾ -->
            <div id="users-tab" class="tab-content">
                <div class="section">
                    <h2>ç”¨æˆ·ç®¡ç†</h2>
                    <p>æŸ¥çœ‹æ‰€æœ‰ä½¿ç”¨è¿‡å·¥å…·çš„ç”¨æˆ·ä¿¡æ¯ã€‚</p>
                    
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-label">æ€»ç”¨æˆ·æ•°</div>
                            <div class="stat-value" id="totalUsers">0</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">ä»˜è´¹ç”¨æˆ·</div>
                            <div class="stat-value" id="paidUsers">0</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">ç»ˆç”Ÿç”¨æˆ·</div>
                            <div class="stat-value" id="lifetimeUsers">0</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">æ€»æ”¶å…¥</div>
                            <div class="stat-value" id="totalRevenue">0å…ƒ</div>
                        </div>
                    </div>
                    
                    <div class="button-group">
                        <button class="btn btn-primary" onclick="loadUserData()">
                            ğŸ”„ åŠ è½½ç”¨æˆ·æ•°æ®
                        </button>
                        <button class="btn btn-warning" onclick="exportUsersToCSV()">
                            ğŸ‘¥ å¯¼å‡ºç”¨æˆ·æ•°æ®
                        </button>
                    </div>
                    
                    <div id="usersStatus" class="status-message"></div>
                    
                    <div id="usersTableContainer" style="margin-top: 20px;">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>æœºå™¨ç </th>
                                    <th>å‰©ä½™æ¬¡æ•°</th>
                                    <th>æ˜¯å¦ç»ˆç”Ÿ</th>
                                    <th>æœ€åæ”¯ä»˜</th>
                                    <th>æ€»æ”¯ä»˜</th>
                                    <th>æ“ä½œ</th>
                                </tr>
                            </thead>
                            <tbody id="usersTableBody">
                                <!-- ç”¨æˆ·æ•°æ®å°†åŠ¨æ€åŠ è½½åœ¨è¿™é‡Œ -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            
            <!-- æ•°æ®ç»Ÿè®¡æ ‡ç­¾ -->
            <div id="stats-tab" class="tab-content">
                <div class="section">
                    <h2>æ•°æ®ç»Ÿè®¡</h2>
                    <p>æŸ¥çœ‹å·¥å…·ä½¿ç”¨æƒ…å†µå’Œæ”¶å…¥ç»Ÿè®¡ã€‚</p>
                    
                    <div class="stats-grid">
                        <div class="stat-card" style="border-top-color: #3498db;">
                            <div class="stat-label">æ€»æˆæƒç æ•°</div>
                            <div class="stat-value" id="totalLicenses">0</div>
                        </div>
                        <div class="stat-card" style="border-top-color: #2ecc71;">
                            <div class="stat-label">å·²æ¿€æ´»æ•°</div>
                            <div class="stat-value" id="activatedLicenses">0</div>
                        </div>
                        <div class="stat-card" style="border-top-color: #f39c12;">
                            <div class="stat-label">8å…ƒæˆæƒ</div>
                            <div class="stat-value" id="type1Licenses">0</div>
                        </div>
                        <div class="stat-card" style="border-top-color: #9b59b6;">
                            <div class="stat-label">18å…ƒæˆæƒ</div>
                            <div class="stat-value" id="type3Licenses">0</div>
                        </div>
                        <div class="stat-card" style="border-top-color: #e74c3c;">
                            <div class="stat-label">58å…ƒæˆæƒ</div>
                            <div class="stat-value" id="type10Licenses">0</div>
                        </div>
                        <div class="stat-card" style="border-top-color: #1abc9c;">
                            <div class="stat-label">88å…ƒæˆæƒ</div>
                            <div class="stat-value" id="type999Licenses">0</div>
                        </div>
                    </div>
                    
                    <h3>è¿‘æœŸæˆæƒè®°å½•</h3>
                    <div id="recentRecords" style="margin-top: 20px;">
                        <!-- è¿‘æœŸè®°å½•å°†åŠ¨æ€åŠ è½½åœ¨è¿™é‡Œ -->
                    </div>
                    
                    <div class="button-group">
                        <button class="btn btn-primary" onclick="updateStatistics()">
                            ğŸ“ˆ æ›´æ–°ç»Ÿè®¡æ•°æ®
                        </button>
                        <button class="btn btn-warning" onclick="generateReport()">
                            ğŸ“„ ç”Ÿæˆç»Ÿè®¡æŠ¥å‘Š
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="footer">
            <p>æŠ•æ ‡å·¥å…·æˆæƒç®¡ç†ç«¯ v1.0 | å¼€å‘è€…ä¸“ç”¨å·¥å…·</p>
            <p>è¯´æ˜ï¼šæ­¤å·¥å…·ç”¨äºç”Ÿæˆå’Œç®¡ç†ç”¨æˆ·æˆæƒç ï¼Œè¯·å¦¥å–„ä¿ç®¡</p>
            <p>å¼€å‘è€…ï¼š2026Developer@sy | é‚®ç®±ï¼š65496209@qq.com</p>
        </div>
    </div>

    <script>
        // å…¨å±€å˜é‡
        let currentLicenseCode = null;
        let licenseRecords = [];
        let userData = [];
        
        // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            // åŠ è½½æœ¬åœ°å­˜å‚¨çš„æ•°æ®
            loadLocalData();
            
            // æ˜¾ç¤ºé»˜è®¤æ ‡ç­¾
            showTab('generate');
            
            // æ›´æ–°ç»Ÿè®¡æ•°æ®
            updateStatistics();
        });
        
        // æ˜¾ç¤ºæ ‡ç­¾é¡µ
        function showTab(tabName) {
            // éšè—æ‰€æœ‰æ ‡ç­¾å†…å®¹
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // ç§»é™¤æ‰€æœ‰æ ‡ç­¾çš„activeç±»
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // æ˜¾ç¤ºé€‰ä¸­çš„æ ‡ç­¾å†…å®¹
            document.getElementById(tabName + '-tab').classList.add('active');
            
            // æ¿€æ´»é€‰ä¸­çš„æ ‡ç­¾
            document.querySelectorAll('.tab').forEach(tab => {
                if (tab.textContent.includes(getTabName(tabName))) {
                    tab.classList.add('active');
                }
            });
            
            // å¦‚æœæ˜¯è®°å½•æ ‡ç­¾ï¼ŒåŠ è½½è®°å½•
            if (tabName === 'records') {
                loadLicenseRecords();
            } else if (tabName === 'users') {
                loadUserData();
            } else if (tabName === 'stats') {
                updateStatistics();
            }
        }
        
        // è·å–æ ‡ç­¾æ˜¾ç¤ºåç§°
        function getTabName(tabKey) {
            const tabNames = {
                'generate': 'ç”Ÿæˆæˆæƒç ',
                'verify': 'éªŒè¯æˆæƒç ',
                'records': 'æˆæƒè®°å½•',
                'users': 'ç”¨æˆ·ç®¡ç†',
                'stats': 'æ•°æ®ç»Ÿè®¡'
            };
            return tabNames[tabKey] || tabKey;
        }
        
        // åŠ è½½æœ¬åœ°æ•°æ®
        function loadLocalData() {
            // åŠ è½½æˆæƒè®°å½•
            const savedRecords = localStorage.getItem('licenseRecords');
            if (savedRecords) {
                try {
                    licenseRecords = JSON.parse(savedRecords);
                } catch (e) {
                    console.error('åŠ è½½æˆæƒè®°å½•å¤±è´¥:', e);
                    licenseRecords = [];
                }
            }
            
            // åŠ è½½ç”¨æˆ·æ•°æ®ï¼ˆæ¥è‡ªå·¥å…·ç«¯ï¼‰
            const savedUsers = localStorage.getItem('bidToolUsers');
            if (savedUsers) {
                try {
                    userData = JSON.parse(savedUsers);
                } catch (e) {
                    console.error('åŠ è½½ç”¨æˆ·æ•°æ®å¤±è´¥:', e);
                    userData = [];
                }
            }
        }
        
        // ç”Ÿæˆæˆæƒç 
        function generateLicense() {
            const authRequestCode = document.getElementById('authRequestCode').value.trim();
            const userAmount = parseInt(document.getElementById('userAmount').value);
            const userEmail = document.getElementById('userEmail').value.trim();
            const userName = document.getElementById('userName').value.trim();
            
            // éªŒè¯è¾“å…¥
            if (!authRequestCode) {
                showStatus('generateStatus', 'error', 'è¯·è¾“å…¥æˆæƒè¯·æ±‚ç ');
                return;
            }
            
            if (!authRequestCode.startsWith('AUTH-REQ-')) {
                showStatus('generateStatus', 'error', 'æˆæƒè¯·æ±‚ç æ ¼å¼ä¸æ­£ç¡®');
                return;
            }
            
            if (!userEmail && !userName) {
                showStatus('generateStatus', 'error', 'è¯·è¾“å…¥ç”¨æˆ·é‚®ç®±æˆ–å§“å');
                return;
            }
            
            // è§£ææˆæƒè¯·æ±‚ç 
            const parts = authRequestCode.split('-');
            if (parts.length !== 4) {
                showStatus('generateStatus', 'error', 'æˆæƒè¯·æ±‚ç æ ¼å¼ä¸æ­£ç¡®ï¼Œåº”ä¸ºï¼šAUTH-REQ-æ—¶é—´æˆ³-éšæœºç ');
                return;
            }
            
            const timestamp = parts[2];
            const randomStr = parts[3];
            
            // éªŒè¯æ—¶é—´æˆ³
            if (!/^\d+$/.test(timestamp)) {
                showStatus('generateStatus', 'error', 'æˆæƒè¯·æ±‚ç ä¸­çš„æ—¶é—´æˆ³æ ¼å¼ä¸æ­£ç¡®');
                return;
            }
            
            // æ ¹æ®é‡‘é¢ç¡®å®šç±»å‹ä»£ç å’Œä½¿ç”¨æ¬¡æ•°
            let typeCode, times;
            switch(userAmount) {
                case 8:
                    typeCode = '001';
                    times = 1;
                    break;
                case 18:
                    typeCode = '003';
                    times = 3;
                    break;
                case 58:
                    typeCode = '010';
                    times = 10;
                    break;
                case 88:
                    typeCode = '999';
                    times = 9999; // ç»ˆç”Ÿä½¿ç”¨
                    break;
                default:
                    typeCode = '001';
                    times = 1;
            }
            
            // ç”Ÿæˆç­¾å
            const signature = generateSignature(typeCode, timestamp, randomStr);
            
            // ç”Ÿæˆæˆæƒç 
            currentLicenseCode = `AUTH-${typeCode}-${timestamp}-${randomStr}-${signature}`;
            
            // æ˜¾ç¤ºç»“æœ
            document.getElementById('licenseCodeDisplay').textContent = currentLicenseCode;
            document.getElementById('emailLicenseCode').textContent = currentLicenseCode;
            document.getElementById('licenseResult').style.display = 'block';
            
            // å¯ç”¨å¤åˆ¶æŒ‰é’®
            document.getElementById('copyBtn').disabled = false;
            
            // æ˜¾ç¤ºæˆåŠŸçŠ¶æ€
            showStatus('generateStatus', 'success', `æˆæƒç ç”ŸæˆæˆåŠŸï¼ç±»å‹ï¼š${userAmount}å…ƒï¼Œä½¿ç”¨æ¬¡æ•°ï¼š${times}`);
            
            // è‡ªåŠ¨æ»šåŠ¨åˆ°ç»“æœ
            document.getElementById('licenseResult').scrollIntoView({ behavior: 'smooth' });
        }
        
        // ç”Ÿæˆç­¾åï¼ˆä¸å·¥å…·ç«¯ç›¸åŒçš„ç®—æ³•ï¼‰
        function generateSignature(typeCode, timestamp, randomStr) {
            // ç®€åŒ–çš„ç­¾åç®—æ³•
            const secret = '2026Developer@sy'; // å¼€å‘è€…å¯†é’¥
            const str = `${typeCode}-${timestamp}-${randomStr}-${secret}`;
            
            let hash = 0;
            for (let i = 0; i < str.length; i++) {
                const char = str.charCodeAt(i);
                hash = ((hash << 5) - hash) + char;
                hash = hash & hash;
            }
            
            return Math.abs(hash).toString(16).substring(0, 4).toUpperCase();
        }
        
        // æµ‹è¯•ç”Ÿæˆæˆæƒç 
        function testLicenseGeneration() {
            // ç”Ÿæˆæµ‹è¯•ç”¨çš„æˆæƒè¯·æ±‚ç 
            const timestamp = Date.now();
            const randomStr = Math.random().toString(36).substring(2, 10).toUpperCase();
            const testRequestCode = `AUTH-REQ-${timestamp}-${randomStr}`;
            
            // å¡«å…¥è¡¨å•
            document.getElementById('authRequestCode').value = testRequestCode;
            document.getElementById('userAmount').value = '18';
            document.getElementById('userEmail').value = 'test@example.com';
            document.getElementById('userName').value = 'æµ‹è¯•ç”¨æˆ·';
            document.getElementById('paymentProof').value = 'æµ‹è¯•æ”¯ä»˜å‡­è¯';
            
            showStatus('generateStatus', 'info', 'å·²å¡«å…¥æµ‹è¯•æ•°æ®ï¼Œè¯·ç‚¹å‡»"ç”Ÿæˆæˆæƒç "æŒ‰é’®');
        }
        
        // å¤åˆ¶æˆæƒç 
        function copyLicenseCode() {
            if (!currentLicenseCode) {
                showStatus('generateStatus', 'error', 'è¯·å…ˆç”Ÿæˆæˆæƒç ');
                return;
            }
            
            copyToClipboard(currentLicenseCode);
            showStatus('generateStatus', 'success', 'æˆæƒç å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼');
        }
        
        // å¤åˆ¶é‚®ä»¶æ¨¡æ¿
        function copyEmailTemplate() {
            const emailTemplate = document.querySelector('.email-template').textContent;
            copyToClipboard(emailTemplate);
            showStatus('generateStatus', 'success', 'é‚®ä»¶æ¨¡æ¿å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼');
        }
        
        // ä¿å­˜æˆæƒè®°å½•
        function saveLicenseRecord() {
            if (!currentLicenseCode) {
                showStatus('generateStatus', 'error', 'è¯·å…ˆç”Ÿæˆæˆæƒç ');
                return;
            }
            
            const authRequestCode = document.getElementById('authRequestCode').value.trim();
            const userAmount = parseInt(document.getElementById('userAmount').value);
            const userEmail = document.getElementById('userEmail').value.trim();
            const userName = document.getElementById('userName').value.trim();
            const paymentProof = document.getElementById('paymentProof').value.trim();
            
            // è§£ææˆæƒç è·å–ä¿¡æ¯
            const parts = currentLicenseCode.split('-');
            const typeCode = parts[1];
            const timestamp = parts[2];
            
            // ç¡®å®šä½¿ç”¨æ¬¡æ•°
            let times;
            switch(typeCode) {
                case '001': times = 1; break;
                case '003': times = 3; break;
                case '010': times = 10; break;
                case '999': times = 9999; break;
                default: times = 1;
            }
            
            // åˆ›å»ºè®°å½•å¯¹è±¡
            const record = {
                id: Date.now(),
                requestCode: authRequestCode,
                licenseCode: currentLicenseCode,
                typeCode: typeCode,
                amount: userAmount,
                times: times,
                userEmail: userEmail,
                userName: userName,
                paymentProof: paymentProof,
                generatedAt: new Date().toISOString(),
                activated: false,
                activatedAt: null,
                machineCode: null,
                notes: ''
            };
            
            // æ·»åŠ åˆ°è®°å½•æ•°ç»„
            licenseRecords.push(record);
            
            // ä¿å­˜åˆ°localStorage
            localStorage.setItem('licenseRecords', JSON.stringify(licenseRecords));
            
            // æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
            showStatus('generateStatus', 'success', 'æˆæƒè®°å½•å·²ä¿å­˜ï¼');
            
            // æ›´æ–°ç»Ÿè®¡æ•°æ®
            updateStatistics();
        }
        
        // éªŒè¯æˆæƒç 
        function verifyLicense() {
            const licenseCode = document.getElementById('verifyLicenseCode').value.trim();
            
            if (!licenseCode) {
                showStatus('verifyStatus', 'error', 'è¯·è¾“å…¥æˆæƒç ');
                return;
            }
            
            if (!licenseCode.startsWith('AUTH-')) {
                showStatus('verifyStatus', 'error', 'æˆæƒç æ ¼å¼ä¸æ­£ç¡®');
                return;
            }
            
            // è§£ææˆæƒç 
            const parts = licenseCode.split('-');
            if (parts.length !== 5) {
                showStatus('verifyStatus', 'error', 'æˆæƒç æ ¼å¼ä¸æ­£ç¡®ï¼Œåº”ä¸ºï¼šAUTH-ç±»å‹-æ—¶é—´æˆ³-éšæœºç -ç­¾å');
                return;
            }
            
            const typeCode = parts[1];
            const timestamp = parts[2];
            const randomStr = parts[3];
            const signature = parts[4];
            
            // éªŒè¯ç­¾å
            const expectedSignature = generateSignature(typeCode, timestamp, randomStr);
            if (signature !== expectedSignature) {
                showStatus('verifyStatus', 'error', 'æˆæƒç ç­¾åéªŒè¯å¤±è´¥ï¼Œå¯èƒ½è¢«ç¯¡æ”¹');
                return;
            }
            
            // æ£€æŸ¥æ—¶é—´æˆ³æ˜¯å¦åœ¨æœ‰æ•ˆæœŸå†…ï¼ˆ30å¤©å†…ï¼‰
            const licenseTime = parseInt(timestamp);
            const now = Date.now();
            const thirtyDays = 30 * 24 * 60 * 60 * 1000;
            
            if (now - licenseTime > thirtyDays) {
                showStatus('verifyStatus', 'error', 'æˆæƒç å·²è¿‡æœŸï¼ˆè¶…è¿‡30å¤©ï¼‰');
                return;
            }
            
            // æŸ¥æ‰¾è®°å½•
            const record = licenseRecords.find(r => r.licenseCode === licenseCode);
            
            // æ˜¾ç¤ºéªŒè¯ç»“æœ
            document.getElementById('verifyResult').style.display = 'block';
            document.getElementById('verifyCode').textContent = licenseCode;
            
            // è®¾ç½®ç±»å‹æ˜¾ç¤º
            let typeText = '', typeClass = '', times = 1, amount = 8;
            switch(typeCode) {
                case '001':
                    typeText = '8å…ƒ/1æ¬¡';
                    typeClass = 'type-1';
                    times = 1;
                    amount = 8;
                    break;
                case '003':
                    typeText = '18å…ƒ/3æ¬¡';
                    typeClass = 'type-3';
                    times = 3;
                    amount = 18;
                    break;
                case '010':
                    typeText = '58å…ƒ/10æ¬¡';
                    typeClass = 'type-10';
                    times = 10;
                    amount = 58;
                    break;
                case '999':
                    typeText = '88å…ƒ/ç»ˆç”Ÿ';
                    typeClass = 'type-999';
                    times = 9999;
                    amount = 88;
                    break;
            }
            
            document.getElementById('verifyType').textContent = typeText;
            document.getElementById('verifyType').className = `record-type ${typeClass}`;
            
            document.getElementById('verifyTimes').textContent = times + 'æ¬¡';
            document.getElementById('verifyAmount').textContent = amount + 'å…ƒ';
            
            const generatedTime = new Date(licenseTime).toLocaleString('zh-CN');
            document.getElementById('verifyGenerated').textContent = generatedTime;
            
            if (record) {
                document.getElementById('verifyStatusText').textContent = record.activated ? 'å·²æ¿€æ´»' : 'æœªæ¿€æ´»';
                document.getElementById('verifyStatusText').style.color = record.activated ? '#27ae60' : '#e74c3c';
                
                document.getElementById('verifyActivated').textContent = record.activatedAt ? 
                    new Date(record.activatedAt).toLocaleString('zh-CN') : 'æœªæ¿€æ´»';
                document.getElementById('verifyMachineCode').textContent = record.machineCode || 'æœªçŸ¥';
            } else {
                document.getElementById('verifyStatusText').textContent = 'æœªæ‰¾åˆ°è®°å½•';
                document.getElementById('verifyActivated').textContent = 'æœªæ‰¾åˆ°è®°å½•';
                document.getElementById('verifyMachineCode').textContent = 'æœªæ‰¾åˆ°è®°å½•';
            }
            
            showStatus('verifyStatus', 'success', 'æˆæƒç éªŒè¯é€šè¿‡ï¼');
        }
        
        // åŠ è½½æ‰€æœ‰æˆæƒç 
        function loadAllLicenses() {
            if (licenseRecords.length === 0) {
                showStatus('verifyStatus', 'info', 'æš‚æ— æˆæƒè®°å½•');
                return;
            }
            
            let html = '';
            licenseRecords.forEach(record => {
                let typeText = '', typeClass = '';
                switch(record.typeCode) {
                    case '001': typeText = '8å…ƒ/1æ¬¡'; typeClass = 'type-1'; break;
                    case '003': typeText = '18å…ƒ/3æ¬¡'; typeClass = 'type-3'; break;
                    case '010': typeText = '58å…ƒ/10æ¬¡'; typeClass = 'type-10'; break;
                    case '999': typeText = '88å…ƒ/ç»ˆç”Ÿ'; typeClass = 'type-999'; break;
                }
                
                html += `
                    <div class="record-item">
                        <div class="record-header">
                            <span class="record-code">${record.licenseCode}</span>
                            <span class="record-type ${typeClass}">${typeText}</span>
                        </div>
                        <div class="record-details">
                            <div><strong>ç”¨æˆ·ï¼š</strong>${record.userName || 'æœªè®°å½•'}</div>
                            <div><strong>é‚®ç®±ï¼š</strong>${record.userEmail || 'æœªè®°å½•'}</div>
                            <div><strong>ç”Ÿæˆæ—¶é—´ï¼š</strong>${new Date(record.generatedAt).toLocaleString('zh-CN')}</div>
                            <div><strong>çŠ¶æ€ï¼š</strong>${record.activated ? 'å·²æ¿€æ´»' : 'æœªæ¿€æ´»'}</div>
                        </div>
                        <div class="record-actions">
                            <button class="btn copy-btn" onclick="copyToClipboard('${record.licenseCode}')">å¤åˆ¶</button>
                            <button class="btn btn-primary" onclick="viewRecordDetails(${record.id})">è¯¦æƒ…</button>
                        </div>
                    </div>
                `;
            });
            
            document.getElementById('licensesList').innerHTML = html;
            document.getElementById('allLicenses').style.display = 'block';
            
            showStatus('verifyStatus', 'info', `å·²åŠ è½½ ${licenseRecords.length} æ¡æˆæƒè®°å½•`);
        }
        
        // æŸ¥çœ‹è®°å½•è¯¦æƒ…
        function viewRecordDetails(recordId) {
            const record = licenseRecords.find(r => r.id === recordId);
            if (!record) return;
            
            // å¡«å……åˆ°éªŒè¯è¡¨å•
            document.getElementById('verifyLicenseCode').value = record.licenseCode;
            
            // åˆ‡æ¢åˆ°éªŒè¯æ ‡ç­¾
            showTab('verify');
            
            // æ‰§è¡ŒéªŒè¯
            setTimeout(() => {
                verifyLicense();
            }, 100);
        }
        
        // åŠ è½½æˆæƒè®°å½•
        function loadLicenseRecords() {
            if (licenseRecords.length === 0) {
                document.getElementById('recordsList').innerHTML = '<p style="text-align: center; color: #7f8c8d;">æš‚æ— æˆæƒè®°å½•</p>';
                return;
            }
            
            // æŒ‰ç”Ÿæˆæ—¶é—´å€’åºæ’åº
            const sortedRecords = [...licenseRecords].sort((a, b) => new Date(b.generatedAt) - new Date(a.generatedAt));
            
            let html = '';
            sortedRecords.forEach(record => {
                let typeText = '', typeClass = '';
                switch(record.typeCode) {
                    case '001': typeText = '8å…ƒ/1æ¬¡'; typeClass = 'type-1'; break;
                    case '003': typeText = '18å…ƒ/3æ¬¡'; typeClass = 'type-3'; break;
                    case '010': typeText = '58å…ƒ/10æ¬¡'; typeClass = 'type-10'; break;
                    case '999': typeText = '88å…ƒ/ç»ˆç”Ÿ'; typeClass = 'type-999'; break;
                }
                
                const generatedTime = new Date(record.generatedAt).toLocaleString('zh-CN');
                const activatedTime = record.activatedAt ? new Date(record.activatedAt).toLocaleString('zh-CN') : 'æœªæ¿€æ´»';
                
                html += `
                    <div class="record-item">
                        <div class="record-header">
                            <span class="record-code">${record.licenseCode.substring(0, 20)}...</span>
                            <span class="record-type ${typeClass}">${typeText}</span>
                        </div>
                        <div class="record-details">
                            <div><strong>ç”¨æˆ·ï¼š</strong>${record.userName || 'æœªè®°å½•'}</div>
                            <div><strong>é‚®ç®±ï¼š</strong>${record.userEmail || 'æœªè®°å½•'}</div>
                            <div><strong>é‡‘é¢ï¼š</strong>${record.amount}å…ƒ</div>
                            <div><strong>ä½¿ç”¨æ¬¡æ•°ï¼š</strong>${record.times}æ¬¡</div>
                            <div><strong>ç”Ÿæˆæ—¶é—´ï¼š</strong>${generatedTime}</div>
                            <div><strong>æ¿€æ´»çŠ¶æ€ï¼š</strong><span style="color: ${record.activated ? '#27ae60' : '#e74c3c'}">${record.activated ? 'å·²æ¿€æ´»' : 'æœªæ¿€æ´»'}</span></div>
                            <div><strong>æ¿€æ´»æ—¶é—´ï¼š</strong>${activatedTime}</div>
                            <div><strong>æœºå™¨ç ï¼š</strong>${record.machineCode || 'æœªæ¿€æ´»'}</div>
                        </div>
                        <div class="record-actions">
                            <button class="btn copy-btn" onclick="copyToClipboard('${record.licenseCode}')">å¤åˆ¶æˆæƒç </button>
                            <button class="btn btn-primary" onclick="editRecord(${record.id})">ç¼–è¾‘</button>
                            <button class="btn btn-danger" onclick="deleteRecord(${record.id})">åˆ é™¤</button>
                        </div>
                    </div>
                `;
            });
            
            document.getElementById('recordsList').innerHTML = html;
            showStatus('recordsStatus', 'success', `å·²åŠ è½½ ${licenseRecords.length} æ¡è®°å½•`);
        }
        
        // æœç´¢æˆæƒè®°å½•
        function searchLicenseRecords() {
            const searchTerm = document.getElementById('searchRecords').value.toLowerCase().trim();
            
            if (!searchTerm) {
                loadLicenseRecords();
                return;
            }
            
            const filteredRecords = licenseRecords.filter(record => 
                record.licenseCode.toLowerCase().includes(searchTerm) ||
                (record.userEmail && record.userEmail.toLowerCase().includes(searchTerm)) ||
                (record.userName && record.userName.toLowerCase().includes(searchTerm)) ||
                (record.machineCode && record.machineCode.toLowerCase().includes(searchTerm)) ||
                record.typeCode.includes(searchTerm)
            );
            
            if (filteredRecords.length === 0) {
                document.getElementById('recordsList').innerHTML = '<p style="text-align: center; color: #7f8c8d;">æœªæ‰¾åˆ°åŒ¹é…çš„è®°å½•</p>';
                return;
            }
            
            let html = '';
            filteredRecords.forEach(record => {
                let typeText = '', typeClass = '';
                switch(record.typeCode) {
                    case '001': typeText = '8å…ƒ/1æ¬¡'; typeClass = 'type-1'; break;
                    case '003': typeText = '18å…ƒ/3æ¬¡'; typeClass = 'type-3'; break;
                    case '010': typeText = '58å…ƒ/10æ¬¡'; typeClass = 'type-10'; break;
                    case '999': typeText = '88å…ƒ/ç»ˆç”Ÿ'; typeClass = 'type-999'; break;
                }
                
                const generatedTime = new Date(record.generatedAt).toLocaleString('zh-CN');
                
                html += `
                    <div class="record-item">
                        <div class="record-header">
                            <span class="record-code">${record.licenseCode.substring(0, 20)}...</span>
                            <span class="record-type ${typeClass}">${typeText}</span>
                        </div>
                        <div class="record-details">
                            <div><strong>ç”¨æˆ·ï¼š</strong>${record.userName || 'æœªè®°å½•'}</div>
                            <div><strong>é‚®ç®±ï¼š</strong>${record.userEmail || 'æœªè®°å½•'}</div>
                            <div><strong>ç”Ÿæˆæ—¶é—´ï¼š</strong>${generatedTime}</div>
                            <div><strong>çŠ¶æ€ï¼š</strong><span style="color: ${record.activated ? '#27ae60' : '#e74c3c'}">${record.activated ? 'å·²æ¿€æ´»' : 'æœªæ¿€æ´»'}</span></div>
                        </div>
                    </div>
                `;
            });
            
            document.getElementById('recordsList').innerHTML = html;
            showStatus('recordsStatus', 'info', `æ‰¾åˆ° ${filteredRecords.length} æ¡åŒ¹é…è®°å½•`);
        }
        
        // ç¼–è¾‘è®°å½•
        function editRecord(recordId) {
            const record = licenseRecords.find(r => r.id === recordId);
            if (!record) return;
            
            const newNotes = prompt('è¯·è¾“å…¥å¤‡æ³¨ä¿¡æ¯ï¼ˆå¯é€‰ï¼‰ï¼š', record.notes || '');
            if (newNotes !== null) {
                record.notes = newNotes;
                localStorage.setItem('licenseRecords', JSON.stringify(licenseRecords));
                loadLicenseRecords();
                showStatus('recordsStatus', 'success', 'è®°å½•å·²æ›´æ–°');
            }
        }
        
        // åˆ é™¤è®°å½•
        function deleteRecord(recordId) {
            if (!confirm('ç¡®å®šè¦åˆ é™¤è¿™æ¡è®°å½•å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ã€‚')) {
                return;
            }
            
            const index = licenseRecords.findIndex(r => r.id === recordId);
            if (index !== -1) {
                licenseRecords.splice(index, 1);
                localStorage.setItem('licenseRecords', JSON.stringify(licenseRecords));
                loadLicenseRecords();
                updateStatistics();
                showStatus('recordsStatus', 'success', 'è®°å½•å·²åˆ é™¤');
            }
        }
        
        // å¯¼å‡ºè®°å½•ä¸ºCSV
        function exportRecordsToCSV() {
            if (licenseRecords.length === 0) {
                showStatus('recordsStatus', 'error', 'æ²¡æœ‰å¯å¯¼å‡ºçš„è®°å½•');
                return;
            }
            
            // CSVè¡¨å¤´
            let csv = 'æˆæƒç ,ç±»å‹,é‡‘é¢(å…ƒ),ä½¿ç”¨æ¬¡æ•°,ç”¨æˆ·,é‚®ç®±,ç”Ÿæˆæ—¶é—´,æ¿€æ´»çŠ¶æ€,æ¿€æ´»æ—¶é—´,æœºå™¨ç ,å¤‡æ³¨\n';
            
            // æ·»åŠ æ•°æ®è¡Œ
            licenseRecords.forEach(record => {
                let typeText = '';
                switch(record.typeCode) {
                    case '001': typeText = '8å…ƒ/1æ¬¡'; break;
                    case '003': typeText = '18å…ƒ/3æ¬¡'; break;
                    case '010': typeText = '58å…ƒ/10æ¬¡'; break;
                    case '999': typeText = '88å…ƒ/ç»ˆç”Ÿ'; break;
                }
                
                const row = [
                    record.licenseCode,
                    typeText,
                    record.amount,
                    record.times,
                    record.userName || '',
                    record.userEmail || '',
                    new Date(record.generatedAt).toLocaleString('zh-CN'),
                    record.activated ? 'å·²æ¿€æ´»' : 'æœªæ¿€æ´»',
                    record.activatedAt ? new Date(record.activatedAt).toLocaleString('zh-CN') : '',
                    record.machineCode || '',
                    record.notes || ''
                ].map(field => `"${field}"`).join(',');
                
                csv += row + '\n';
            });
            
            // åˆ›å»ºä¸‹è½½é“¾æ¥
            const blob = new Blob(['\uFEFF' + csv], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = `æˆæƒè®°å½•_${new Date().toISOString().slice(0, 10)}.csv`;
            link.click();
            
            showStatus('recordsStatus', 'success', 'CSVæ–‡ä»¶å·²å¯¼å‡º');
        }
        
        // æ¸…ç©ºæ‰€æœ‰è®°å½•
        function clearAllRecords() {
            if (!confirm('ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰æˆæƒè®°å½•å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ï¼')) {
                return;
            }
            
            if (!confirm('å†æ¬¡ç¡®è®¤ï¼šè¿™å°†åˆ é™¤æ‰€æœ‰æˆæƒè®°å½•ï¼ŒåŒ…æ‹¬å·²æ¿€æ´»çš„è®°å½•ã€‚')) {
                return;
            }
            
            licenseRecords = [];
            localStorage.setItem('licenseRecords', JSON.stringify(licenseRecords));
            loadLicenseRecords();
            updateStatistics();
            showStatus('recordsStatus', 'success', 'æ‰€æœ‰è®°å½•å·²æ¸…ç©º');
        }
        
        // åŠ è½½ç”¨æˆ·æ•°æ®
        function loadUserData() {
            // ä»localStorageåŠ è½½ç”¨æˆ·æ•°æ®
            const savedUsers = localStorage.getItem('bidToolUsers');
            if (!savedUsers) {
                document.getElementById('usersTableBody').innerHTML = '<tr><td colspan="7" style="text-align: center; color: #7f8c8d;">æš‚æ— ç”¨æˆ·æ•°æ®</td></tr>';
                showStatus('usersStatus', 'info', 'æœªæ‰¾åˆ°ç”¨æˆ·æ•°æ®');
                return;
            }
            
            try {
                userData = JSON.parse(savedUsers);
                
                // æ›´æ–°ç»Ÿè®¡æ•°æ®
                const totalUsers = userData.length;
                const paidUsers = userData.filter(u => u.totalPayments > 0).length;
                const lifetimeUsers = userData.filter(u => u.isUnlimited).length;
                const totalRevenue = userData.reduce((sum, u) => sum + u.totalPayments, 0);
                
                document.getElementById('totalUsers').textContent = totalUsers;
                document.getElementById('paidUsers').textContent = paidUsers;
                document.getElementById('lifetimeUsers').textContent = lifetimeUsers;
                document.getElementById('totalRevenue').textContent = totalRevenue + 'å…ƒ';
                
                // ç”Ÿæˆè¡¨æ ¼
                let html = '';
                userData.forEach(user => {
                    const lastPayment = user.lastPayment ? new Date(user.lastPayment).toLocaleString('zh-CN') : 'ä»æœªæ”¯ä»˜';
                    const remainingUses = user.isUnlimited ? 'æ— é™' : user.remainingUses;
                    
                    html += `
                        <tr>
                            <td>${user.id}</td>
                            <td><span title="${user.machineCode}">${user.machineCode.substring(0, 15)}...</span></td>
                            <td>${remainingUses}</td>
                            <td>${user.isUnlimited ? 'æ˜¯' : 'å¦'}</td>
                            <td>${lastPayment}</td>
                            <td>${user.totalPayments || 0}å…ƒ</td>
                            <td>
                                <button class="copy-btn" onclick="copyToClipboard('${user.machineCode}')">å¤åˆ¶æœºå™¨ç </button>
                            </td>
                        </tr>
                    `;
                });
                
                document.getElementById('usersTableBody').innerHTML = html;
                showStatus('usersStatus', 'success', `å·²åŠ è½½ ${userData.length} æ¡ç”¨æˆ·æ•°æ®`);
                
            } catch (e) {
                console.error('è§£æç”¨æˆ·æ•°æ®å¤±è´¥:', e);
                showStatus('usersStatus', 'error', 'åŠ è½½ç”¨æˆ·æ•°æ®å¤±è´¥');
            }
        }
        
        // å¯¼å‡ºç”¨æˆ·æ•°æ®ä¸ºCSV
        function exportUsersToCSV() {
            if (userData.length === 0) {
                showStatus('usersStatus', 'error', 'æ²¡æœ‰å¯å¯¼å‡ºçš„ç”¨æˆ·æ•°æ®');
                return;
            }
            
            // CSVè¡¨å¤´
            let csv = 'ID,æœºå™¨ç ,å‰©ä½™æ¬¡æ•°,æ˜¯å¦ç»ˆç”Ÿ,æœ€åæ”¯ä»˜æ—¶é—´,æ€»æ”¯ä»˜é‡‘é¢(å…ƒ),é‚®ç®±\n';
            
            // æ·»åŠ æ•°æ®è¡Œ
            userData.forEach(user => {
                const lastPayment = user.lastPayment ? new Date(user.lastPayment).toLocaleString('zh-CN') : 'ä»æœªæ”¯ä»˜';
                const remainingUses = user.isUnlimited ? 'æ— é™' : user.remainingUses;
                
                const row = [
                    user.id,
                    user.machineCode,
                    remainingUses,
                    user.isUnlimited ? 'æ˜¯' : 'å¦',
                    lastPayment,
                    user.totalPayments || 0,
                    user.email || ''
                ].map(field => `"${field}"`).join(',');
                
                csv += row + '\n';
            });
            
            // åˆ›å»ºä¸‹è½½é“¾æ¥
            const blob = new Blob(['\uFEFF' + csv], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = `ç”¨æˆ·æ•°æ®_${new Date().toISOString().slice(0, 10)}.csv`;
            link.click();
            
            showStatus('usersStatus', 'success', 'ç”¨æˆ·æ•°æ®CSVæ–‡ä»¶å·²å¯¼å‡º');
        }
        
        // æ›´æ–°ç»Ÿè®¡æ•°æ®
        function updateStatistics() {
            // æ›´æ–°æˆæƒç ç»Ÿè®¡
            document.getElementById('totalLicenses').textContent = licenseRecords.length;
            
            const activatedCount = licenseRecords.filter(r => r.activated).length;
            document.getElementById('activatedLicenses').textContent = activatedCount;
            
            const type1Count = licenseRecords.filter(r => r.typeCode === '001').length;
            const type3Count = licenseRecords.filter(r => r.typeCode === '003').length;
            const type10Count = licenseRecords.filter(r => r.typeCode === '010').length;
            const type999Count = licenseRecords.filter(r => r.typeCode === '999').length;
            
            document.getElementById('type1Licenses').textContent = type1Count;
            document.getElementById('type3Licenses').textContent = type3Count;
            document.getElementById('type10Licenses').textContent = type10Count;
            document.getElementById('type999Licenses').textContent = type999Count;
            
            // æ›´æ–°ç”¨æˆ·ç»Ÿè®¡
            if (userData.length > 0) {
                const paidUsers = userData.filter(u => u.totalPayments > 0).length;
                const lifetimeUsers = userData.filter(u => u.isUnlimited).length;
                const totalRevenue = userData.reduce((sum, u) => sum + u.totalPayments, 0);
                
                document.getElementById('totalUsers').textContent = userData.length;
                document.getElementById('paidUsers').textContent = paidUsers;
                document.getElementById('lifetimeUsers').textContent = lifetimeUsers;
                document.getElementById('totalRevenue').textContent = totalRevenue + 'å…ƒ';
            }
            
            // æ˜¾ç¤ºè¿‘æœŸè®°å½•
            showRecentRecords();
        }
        
        // æ˜¾ç¤ºè¿‘æœŸè®°å½•
        function showRecentRecords() {
            if (licenseRecords.length === 0) {
                document.getElementById('recentRecords').innerHTML = '<p style="text-align: center; color: #7f8c8d;">æš‚æ— æˆæƒè®°å½•</p>';
                return;
            }
            
            // æŒ‰ç”Ÿæˆæ—¶é—´å€’åºæ’åºï¼Œå–æœ€è¿‘10æ¡
            const recentRecords = [...licenseRecords]
                .sort((a, b) => new Date(b.generatedAt) - new Date(a.generatedAt))
                .slice(0, 10);
            
            let html = '<table class="data-table"><thead><tr><th>æˆæƒç </th><th>ç±»å‹</th><th>ç”¨æˆ·</th><th>æ—¶é—´</th><th>çŠ¶æ€</th></tr></thead><tbody>';
            
            recentRecords.forEach(record => {
                let typeText = '';
                switch(record.typeCode) {
                    case '001': typeText = '8å…ƒ'; break;
                    case '003': typeText = '18å…ƒ'; break;
                    case '010': typeText = '58å…ƒ'; break;
                    case '999': typeText = '88å…ƒ'; break;
                }
                
                const shortCode = record.licenseCode.substring(0, 15) + '...';
                const time = new Date(record.generatedAt).toLocaleDateString('zh-CN');
                const status = record.activated ? 'å·²æ¿€æ´»' : 'æœªæ¿€æ´»';
                const statusColor = record.activated ? '#27ae60' : '#e74c3c';
                
                html += `
                    <tr>
                        <td title="${record.licenseCode}">${shortCode}</td>
                        <td>${typeText}</td>
                        <td>${record.userName || 'æœªè®°å½•'}</td>
                        <td>${time}</td>
                        <td style="color: ${statusColor}">${status}</td>
                    </tr>
                `;
            });
            
            html += '</tbody></table>';
            document.getElementById('recentRecords').innerHTML = html;
        }
        
        // ç”Ÿæˆç»Ÿè®¡æŠ¥å‘Š
        function generateReport() {
            const totalLicenses = licenseRecords.length;
            const activatedLicenses = licenseRecords.filter(r => r.activated).length;
            const activationRate = totalLicenses > 0 ? ((activatedLicenses / totalLicenses) * 100).toFixed(2) : 0;
            
            const type1Count = licenseRecords.filter(r => r.typeCode === '001').length;
            const type3Count = licenseRecords.filter(r => r.typeCode === '003').length;
            const type10Count = licenseRecords.filter(r => r.typeCode === '010').length;
            const type999Count = licenseRecords.filter(r => r.typeCode === '999').length;
            
            const totalRevenue = type1Count * 8 + type3Count * 18 + type10Count * 58 + type999Count * 88;
            
            const report = `
æŠ•æ ‡å·¥å…·æˆæƒç»Ÿè®¡æŠ¥å‘Š
ç”Ÿæˆæ—¶é—´ï¼š${new Date().toLocaleString('zh-CN')}

ã€æ€»ä½“ç»Ÿè®¡ã€‘
æ€»æˆæƒç æ•°ï¼š${totalLicenses}ä¸ª
å·²æ¿€æ´»æ•°ï¼š${activatedLicenses}ä¸ª
æ¿€æ´»ç‡ï¼š${activationRate}%

ã€æŒ‰ç±»å‹ç»Ÿè®¡ã€‘
8å…ƒæˆæƒï¼ˆ1æ¬¡ï¼‰ï¼š${type1Count}ä¸ª
18å…ƒæˆæƒï¼ˆ3æ¬¡ï¼‰ï¼š${type3Count}ä¸ª
58å…ƒæˆæƒï¼ˆ10æ¬¡ï¼‰ï¼š${type10Count}ä¸ª
88å…ƒæˆæƒï¼ˆç»ˆç”Ÿï¼‰ï¼š${type999Count}ä¸ª

ã€æ”¶å…¥ç»Ÿè®¡ã€‘
8å…ƒæˆæƒæ”¶å…¥ï¼š${type1Count * 8}å…ƒ
18å…ƒæˆæƒæ”¶å…¥ï¼š${type3Count * 18}å…ƒ
58å…ƒæˆæƒæ”¶å…¥ï¼š${type10Count * 58}å…ƒ
88å…ƒæˆæƒæ”¶å…¥ï¼š${type999Count * 88}å…ƒ
æ€»æ”¶å…¥ï¼š${totalRevenue}å…ƒ

ã€ç”¨æˆ·ç»Ÿè®¡ã€‘
æ€»ç”¨æˆ·æ•°ï¼š${userData.length}ä¸ª
ä»˜è´¹ç”¨æˆ·ï¼š${userData.filter(u => u.totalPayments > 0).length}ä¸ª
ç»ˆç”Ÿç”¨æˆ·ï¼š${userData.filter(u => u.isUnlimited).length}ä¸ª

ã€å¤‡æ³¨ã€‘
1. æ­¤æŠ¥å‘Šä¸ºæœ¬åœ°æ•°æ®ç»Ÿè®¡
2. æ•°æ®æ¥æºäºlocalStorageå­˜å‚¨
3. ç»Ÿè®¡æ—¶é—´ï¼š${new Date().toLocaleString('zh-CN')}
            `;
            
            // åˆ›å»ºä¸‹è½½é“¾æ¥
            const blob = new Blob(['\uFEFF' + report], { type: 'text/plain;charset=utf-8;' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = `æˆæƒç»Ÿè®¡æŠ¥å‘Š_${new Date().toISOString().slice(0, 10)}.txt`;
            link.click();
            
            alert('ç»Ÿè®¡æŠ¥å‘Šå·²ç”Ÿæˆå¹¶ä¸‹è½½ï¼');
        }
        
        // æ˜¾ç¤ºçŠ¶æ€æ¶ˆæ¯
        function showStatus(elementId, type, message) {
            const element = document.getElementById(elementId);
            element.className = `status-message status-${type}`;
            element.textContent = message;
            element.style.display = 'block';
            
            // 3ç§’åè‡ªåŠ¨éšè—
            setTimeout(() => {
                element.style.display = 'none';
            }, 3000);
        }
        
        // å¤åˆ¶åˆ°å‰ªè´´æ¿
        function copyToClipboard(text) {
            if (navigator.clipboard && navigator.clipboard.writeText) {
                navigator.clipboard.writeText(text).then(() => {
                    // å¤åˆ¶æˆåŠŸ
                }).catch(err => {
                    fallbackCopyText(text);
                });
            } else {
                fallbackCopyText(text);
            }
        }
        
        // ä¼ ç»Ÿçš„å¤åˆ¶æ–‡æœ¬æ–¹æ³•
        function fallbackCopyText(text) {
            const textArea = document.createElement('textarea');
            textArea.value = text;
            textArea.style.position = 'fixed';
            textArea.style.left = '-999999px';
            textArea.style.top = '-999999px';
            document.body.appendChild(textArea);
            textArea.focus();
            textArea.select();
            
            try {
                document.execCommand('copy');
            } catch (err) {
                console.error('å¤åˆ¶å¤±è´¥:', err);
            }
            
            document.body.removeChild(textArea);
        }
        
        // å·¥å…·ç«¯æˆæƒéªŒè¯å‡½æ•°ï¼ˆä»å·¥å…·ç«¯å¤åˆ¶è¿‡æ¥ï¼Œä¿æŒä¸€è‡´æ€§ï¼‰
        function generateLicenseCodeForDeveloper(authRequestCode, amount, times, machineCode) {
            // è§£ææˆæƒè¯·æ±‚ç 
            const parts = authRequestCode.split('-');
            if (parts.length !== 4 || parts[0] !== 'AUTH' || parts[1] !== 'REQ') {
                return null;
            }
            
            // æ ¹æ®é‡‘é¢ç¡®å®šç±»å‹ä»£ç 
            let typeCode = '001';
            if (amount === 18) typeCode = '003';
            else if (amount === 58) typeCode = '010';
            else if (amount === 88) typeCode = '999';
            
            const timestamp = parts[2];
            const randomStr = parts[3];
            
            // ç”Ÿæˆç­¾å
            const signature = generateSignature(typeCode, timestamp, randomStr);
            
            // ç”Ÿæˆæˆæƒç 
            const licenseCode = `AUTH-${typeCode}-${timestamp}-${randomStr}-${signature}`;
            
            return licenseCode;
        }
    </script>
</body>
</html>